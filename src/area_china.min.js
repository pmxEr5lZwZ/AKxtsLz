var current_province=$('meta[name="province"]').attr('content');var current_city=$('meta[name="city"]').attr('content');var current_district=$('meta[name="district"]').attr('content');var path=$('meta[name="path"]').attr('content');var default_index="";var default_value="- Unknow -";var parent_div="div";var province=document.getElementById('province');var city=document.getElementById('city');var district=document.getElementById('district');var option_list={};city.style.display="none";district.style.display="none";$.getJSON(path,function(data){getProvince();showOption(province);if(current_province!=""&&current_province!=default_index){$(province).val(current_province);if(Object.keys(data[current_province]).length>1&&Object.keys(data[current_province]).length<=3){district.style.display="";getCity(current_province);if(current_district!=""&&current_district!=default_index){$(district).val(current_district)}}else if(Object.keys(data[current_province]).length>3){city.style.display="";getCity(current_province);if(current_city!=""&&current_city!=default_index){district.style.display="";$(city).val(current_city);getDistrict(current_province,current_city);if(current_district!=""&&current_district!=default_index){$(district).val(current_district)}}}}$(province).change(function(){if(province.value===default_index){closeList(city);closeList(district);return}getCity(province.value)});$(city).change(function(){if(city.value===default_index){closeList(district);return}getDistrict(province.value,city.value)});function getProvince(){$.each(data,function(index,value){CreateOptionList(index,value)})}function getCity(province_id){if(Object.keys(data[province_id]).length===1){closeList(city);closeList(district)}else if(Object.keys(data[province_id]).length>1&&Object.keys(data[province_id]).length<=3){closeList(city);getNewList(district);$.each(data[province_id],function(index,value){if(typeof(data[province_id][index])=="object"){$.each(data[province_id][index],function(index_2,value_2){CreateOptionList(index+index_2,value_2)})}});showOption(district)}else if(Object.keys(data[province_id]).length>3){closeList(district);getNewList(city);$.each(data[province_id],function(index,value){if(typeof(data[province_id][index])=="object"){CreateOptionList(index,value)}});showOption(city)}else{alert('error')}}function getDistrict(province_id,city_id){if(Object.keys(data[province_id][city_id])=='name'){closeList(district);return}getNewList(district);$.each(data[province_id][city_id],function(index,value){if(typeof(data[province_id][city_id][index])=="object"){CreateOptionList(index,value)}});showOption(district)}});function getNewList(obj){if(parent_div!==false){$(obj).parents(parent_div).show()}obj.style.display="";initList(obj)}function closeList(obj){if(parent_div!==false){$(obj).parent(parent_div).hide()}obj.style.display="none";initList(obj)}function initList(obj){$(obj).empty();$(obj).append("<option value='"+default_index+"'>"+default_value+"</option>")}function CreateOptionList(index,value){if(index.substr(0,1)==="0"){var key=index.substr(1);option_list[key]="<option value='"+index+"'>"+value.name+"</option>"}else{option_list[index]="<option value='"+index+"'>"+value.name+"</option>"}}function showOption(obj){$.each(option_list,function(index,value){$(obj).append(value)});option_list=[]}